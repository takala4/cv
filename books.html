<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>積読リスト</title>
    <!-- UIkit CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-beta.25/css/uikit.min.css" />
    <link rel="stylesheet" href="./style.css" />
    <link href="https://fonts.googleapis.com/earlyaccess/notosansjapanese.css" rel="stylesheet" />
    <!-- jQuery is required -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- UIkit JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-beta.25/js/uikit.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-beta.25/js/uikit-icons.min.js"></script>
    <meta charset="UTF-8">
    <!-- Favi con -->
    <link rel="shortcut icon" type="image/png" href="image/4-black.png">
    <!-- add the button style & script -->
    <link rel="stylesheet" href="https://unpkg.com/applause-button/dist/applause-button.css" />
    <script src="https://unpkg.com/applause-button/dist/applause-button.js"></script>
    <style>
        applause-button {
            width: 48px;
            height: 48px;
            margin-top: 5px;
            margin-left: 5px;
        }
    </style>

    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-analytics.js"></script>

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCZLnTUdLzs4YEn-f7Dig4XQWl3XXPtcgU",
            authDomain: "takala-books.firebaseapp.com",
            databaseURL: "https://takala-books.firebaseio.com",
            projectId: "takala-books",
            storageBucket: "takala-books.appspot.com",
            messagingSenderId: "542998720057",
            appId: "1:542998720057:web:3d52aa7503b071ce29a7e8",
            measurementId: "G-YX2HH373SK"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>
</head>

<body>
    <div class="uk-container uk-container-center uk-margin-top uk-margin-large-bottom">
        <h1>積読リスト</h1>
        教科書，Kindle，漫画，小説を除く積読の一覧．
        <table class="uk-table uk-table-justify uk-table-divider uk-vertical-align-middle uk-align-center">
            <thead>
                <tr>
                    <th class="uk-width-small">#</th>
                    <th class="uk-width-2xlarge">タイトル</th>
                    <th>star</th>
                </tr>
            </thead>
            <tbody>
                <!--                ここに入る-->
            </tbody>
        </table>
        <h3>このページについて</h3>
        <ul>
            <li>個人的な興味・関心によるものです．このページでは特定の書籍の批評を目的としていません．</li>
            <li>読了後の書評はbook meterというサービスに投稿しています</li>
            <li>書籍にはAmazonリンクが貼られているいます</li>
            <li>このページはGitHubの静的ホスティングサービスを使用しています</li>
        </ul>
    </div>
    <div id="message">
        <h3>登録テスト</h3>
        <ul>
            <li id="chatText"></li>
            <li><input type="text" name="" id="my_text"></li>
            <li><a onclick="changeData()">更新</a></li>
        </ul>
    </div>
    <script type="application/javascript">
        function write_books() {
            var $detpos = $("tbody");

            var db = firebase.database();
            var books = db.ref("/books");

            books.once("value")
                .then(function (snapshot) {
                    snapshot.forEach(function (childSnapshot) {
                        var ISBN = childSnapshot.key;
                        var stars = childSnapshot.child('stars').val();
                        var title = childSnapshot.child('title').val();
                        $detpos.prepend('<tr><td></td><td>' + title +
                            '</td><td>' + stars + '</td></tr>');
                    });
                });
        }

        write_books();


        //Firebase-test
        var db = firebase.database();
        var target_ISBN = "9784478910184";
        var book = db.ref("/books/" + target_ISBN);


        function changeData() {
            var title = document.getElementById("my_text").value;
            book.set({
                title: title,
                stars: 1,
            });
        }
    </script>
</body>

</html>